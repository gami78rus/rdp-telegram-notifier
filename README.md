╔══════════════════════════════════════════════════════════════════════════════╗
║                        🛡️  МОНИТОРИНГ БЕЗОПАСНОСТИ RDP                        ║
║                  📨 ОТПРАВКА УВЕДОМЛЕНИЙ В TELEGRAM                          ║
╚══════════════════════════════════════════════════════════════════════════════╝

📌 РЕПОЗИТОРИЙ СОДЕРЖИТ PowerShell-скрипт для мониторинга событий входа и 
   переподключения по RDP на компьютерах Windows и отправки детализированных 
   уведомлений в Telegram.

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🎯 ОСНОВНЫЕ ВОЗМОЖНОСТИ
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
•  📊 Мониторинг событий входа (Event ID 21) и переподключения (Event ID 25) RDP
•  📨 Отправка детальных уведомлений в указанный чат/группу Telegram
•  📋 В уведомлениях включается:
   ├─ Полное доменное имя (FQDN) хоста
   ├─ Все IPv4-адреса машины
   ├─ Имя учетной записи пользователя
   ├─ IP-адрес источника подключения клиента
   ├─ DNS-имя клиентского IP (если разрешается)
   ├─ Тип события (Вход/Переподключение)
   ├─ ID события
   ├─ Временная метка
   └─ Полное сообщение события
•  ⚙️  Автоматическая установка в качестве запланированной задачи при загрузке системы
•  📦 Все компоненты в одном скрипте PowerShell для простого развертывания

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🚀 ИНСТРУКЦИЯ ПО РАЗВЕРТЫВАНИЮ
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🔹 ШАГ 1: ПОЛУЧЕНИЕ ТОКЕНА TELEGRAM БОТА
     1. Напишите @BotFather в Telegram
     2. Отправьте команду /newbot
     3. Следуйте инструкциям, выберите имя и username для бота
     4. Сохраните полученный API-токен (например, 123456789:ABC-DEF1234ghy)

🔹 ШАГ 2: ПОЛУЧЕНИЕ ID ЧАТА
     • Для личного чата: отправьте любое сообщение боту, затем перешлите 
       это сообщение @RawDataBot или @myidbot
     • Для группового чата: добавьте бота в группу, отправьте сообщение,
       затем добавьте @RawDataBot или @myidbot в ту же группу

🔹 ШАГ 3: НАСТРОЙКА СКРИПТА
     Откройте файл install-monitoring.template.ps1 и найдите строки:

     ┌─────────────────────────────────────────────────────────┐
     │ $BotToken = "ВАШ_ТЕЛЕГРАМ_БОТ_ТОКЕН"                    │
     │ $ChatID = "ВАШ_ID_ЧАТА_ИЛИ_ГРУППЫ"                      │
     └─────────────────────────────────────────────────────────┘

     Замените значения на ваши реальные данные.

🔹 ШАГ 4: ЗАПУСК НА ЦЕЛЕВЫХ МАШИНАХ
     Скопируйте модифицированный скрипт на каждый компьютер Windows.
     Запустите от имени администратора:

     ┌─────────────────────────────────────────────────────────┐
     │ powershell.exe -ExecutionPolicy Bypass -File            │
     │ .\install-monitoring.template.ps1                       │
     └─────────────────────────────────────────────────────────┘

     Скрипт автоматически:
     • Создаст необходимые файлы в C:\ProgramData\TelegramNotifications
     • Установит запланированную задачу TelegramRDPAlert
     • Настроит мониторинг при каждом входе в систему

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🔧 АРХИТЕКТУРА РЕШЕНИЯ
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📁 Основной скрипт включает два вспомогательных:

1. monitor-rdp.ps1
   ├─ Мониторит журнал событий Windows Security
   ├─ Фильтрует события RDP (ID 21, 25)
   ├─ Извлекает: пользователя, IP источника, данные хоста
   └─ Логирует в C:\ProgramData\TelegramNotifications\log.txt

2. send-telegram.ps1
   └─ Отправляет сообщения через Telegram Bot API 
      с использованием Invoke-RestMethod

📅 Запланированная задача обеспечивает постоянный мониторинг 
   при каждой загрузке системы.

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
⚠️  ДЛЯ ОБЪЕКТОВ КИИ И СООТВЕТСТВИЯ ТРЕБОВАНИЯМ 152-ФЗ/187-ФЗ
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
•  Решение помогает выполнять требования по мониторингу и регистрации 
   событий информационной безопасности
•  Обеспечивает оперативное оповещение о несанкционированных 
   подключениях к удаленным рабочим столам
•  Может быть интегрировано с отечественными SIEM-системами
•  Позволяет документировать инциденты для последующего расследования

╔══════════════════════════════════════════════════════════════════════════════╗
║                   [🔐] КИБЕРБЕЗОПАСНОСТЬ НАЧИНАЕТСЯ С МОНИТОРИНГА             ║
╚══════════════════════════════════════════════════════════════════════════════╝
